<div class="category">
  <app-category-toolbar
    [toolbarItems]="toolbarItems"
    [selectedItem]="categoryId"
  ></app-category-toolbar>
  <app-breadcrumbs
    [sortByOptions]="sortByOptions"
    [(sortByFilter)]="sortByFilter"
  ></app-breadcrumbs>
  <div class="category-content">
    <div class="category-content-filters">
      <div class="category-content-filters-category-name">
        {{ category.name }}.
      </div>
      <div class="category-content-filters-title">
        Filters
        <img src="../assets/images/filter.svg" />
      </div>
      <div
        *ngIf="category.id !== 'all-products'"
        class="category-content-filters-filter"
      >
        <div class="category-content-filters-filter-title">Types</div>
        <div class="category-content-filters-list">
          <ul *ngIf="categories.length > 0">
            <div *ngFor="let category of categories">
              <li (click)="filterByCategory(category.id)">
                <span
                  [ngClass]="
                    category.id === categoryFilter ? 'selectedFilter' : ''
                  "
                  >{{ category.title }}</span
                >
              </li>
            </div>
          </ul>
        </div>
      </div>
      <div class="category-content-filters-filter">
        <div class="category-content-filters-filter-title">Price range</div>
        <div class="category-content-filters-price-slider">
          <ng5-slider
            [(value)]="minValue"
            [(highValue)]="maxValue"
            [options]="options"
          ></ng5-slider>
        </div>
      </div>
    </div>

    <div class="category-content-products">
      <ng-container *ngIf="!loading; else loadingBlock">
        <ng-container
          *ngIf="
            (
              productsInCategory
              | filterByCategory: categoryFilter
              | filterByPriceRange: minValue:maxValue
            ).length > 0;
            else noProductsBlock
          "
        >
          <div class="row">
            <div
              *ngFor="
                let product of productsInCategory
                  | filterByCategory: categoryFilter
                  | filterByPriceRange: minValue:maxValue
                  | sortBy: sortByFilter
              "
            >
              <div class="col">
                <div class="product" (click)="goToProduct(product)">
                  <div
                    class="product-image"
                    [ngStyle]="{
                      'background-image': 'url(' + product.image + ')'
                    }"
                  ></div>
                  <div>
                    <div class="product-title">
                      {{ product.name }}
                    </div>
                    <div class="product-price">
                      {{ product.price }}
                      {{ product.currency }}
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </ng-container>
      </ng-container>
      <ng-template #loadingBlock>
        <div>
          Loading products...
        </div>
      </ng-template>
      <ng-template #noProductsBlock>
        <div>
          No products found with this criteria.
        </div>
      </ng-template>
    </div>
  </div>
</div>
